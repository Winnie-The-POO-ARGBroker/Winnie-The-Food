<main class="m-10 container">
  @if (errorMsg()) {
    <app-empty-state [message]="errorMsg()!"></app-empty-state>
  } @else if (receta()) {

    <h2 class="h2-color-1 font-black">{{ receta()?.nombre }}</h2>

    <div class="flex items-center flex-wrap gap-4 mb-4">
      <span>üïê {{ totalTime() }}</span>
      <span>üçΩÔ∏è {{ receta()?.porciones }} porciones</span>

      <div class="nivel-dificultad">
        <div class="circulo"
             [class.facil]="dificultadStr()==='facil'"
             [class.medio]="dificultadStr()==='medio'"
             [class.dificil]="dificultadStr()==='dificil'"></div>
        Dificultad {{ dificultadStr() | titlecase }}
      </div>
    </div>

    <div class="categorias-tags">
      @for (t of (receta()?.tags ?? []); track $index) {
        <div class="categoria-tag">{{ t }}</div>
      }
    </div>

    <div class="imagen-receta">
      <img [src]="receta()?.imageUrl" [alt]="receta()?.nombre" class="w-full h-[400px] object-cover rounded-2xl">
    </div>

    <div class="seccion-superior">
      <div>
        <!-- INGREDIENTES -->
        <section class="modulo-detalle" style="margin-bottom:2rem;">
          <h3 class="h2-color-1 subrayado-naranja">Ingredientes</h3>
          <ul>
            @for (ing of (receta()?.ingredients ?? []); track ing.orden) {
              <li>{{ ing.texto }}</li>
            } @empty {
              <li>‚Äî</li>
            }
          </ul>
        </section>

        <!-- INFORMACI√ìN NUTRICIONAL -->
        <section class="modulo-detalle">
          <h3 class="h2-color-1 subrayado-naranja">Informaci√≥n nutricional</h3>
          <div class="nutricional-boxes">
            @for (n of (receta()?.nutrition ?? []); track n.label) {
              <div class="nutricional-box">
                <strong>{{ n.valueNum ?? '‚Äî' }}</strong><br>
                {{ n.label }}
              </div>
            } @empty {
              <div class="muted">Sin datos.</div>
            }
          </div>
        </section>
      </div>

      <div>
        <!-- PREPARACI√ìN + TIPS -->
        <section class="modulo-detalle">
          <h3 class="h2-color-1 subrayado-naranja">Preparaci√≥n</h3>

          <ol class="lista-pasos">
            @for (p of (receta()?.steps ?? []); track p.orden) {
              <li>
                <span class="badge">{{ p.orden }}</span>
                <span>{{ p.texto }}</span>
              </li>
            } @empty {
              <li>‚Äî</li>
            }
          </ol>

          <div class="consejos-verde">
            <h3 class="h2-color-1">üí° Consejos √ötiles</h3>
            @for (c of (receta()?.tips ?? []); track c.orden) {
              <div class="consejo-verde">
                <div class="check-verde">‚úì</div>
                {{ c.texto }}
              </div>
            } @empty {
              <div class="muted">Sin consejos.</div>
            }
          </div>
        </section>
      </div>
    </div>

    <div style="display:flex;justify-content:center;margin:2rem 0;">
      <button class="btn-personalizado primario" (click)="onAddToFavorites()">Agregar a favoritos</button>
    </div>

    <section class="modulo-detalle">
      <h3 class="titulo-seccion">Recetas Relacionadas</h3>
      <app-featured [recipes]="relatedForFeatured()"></app-featured>
    </section>
  }
</main>
